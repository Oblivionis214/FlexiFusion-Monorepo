"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ensureMetaplexAuctionSource = exports.ensureBonfidaAuctionSource = void 0;
const ensureSource = async (service, existing, input) => {
    const found = existing.find((it) => input.name === it.name);
    if (found !== undefined) {
        return found;
    }
    const newSource = await service.createSource(input);
    existing.push(newSource);
    return newSource;
};
const ensureBonfidaAuctionSource = async (service, existing, input) => {
    const { auctionAddressBase58, auctionName } = input;
    const underlyingAddress = `${auctionName}:;:${auctionAddressBase58}`;
    return await ensureSource(service, existing, {
        name: auctionAddressBase58,
        blockchainAddress: underlyingAddress,
        type: 'SOLANA_BONFIDA_AUCTION',
    });
};
exports.ensureBonfidaAuctionSource = ensureBonfidaAuctionSource;
const ensureMetaplexAuctionSource = async (service, existing, input) => {
    const { auctionAddressBase58, auctionWebUrl } = input;
    const underlyingAddress = `${auctionWebUrl}:;:${auctionAddressBase58}`;
    return await ensureSource(service, existing, {
        name: auctionAddressBase58,
        blockchainAddress: underlyingAddress,
        type: 'SOLANA_METAPLEX_AUCTION',
    });
};
exports.ensureMetaplexAuctionSource = ensureMetaplexAuctionSource;
exports.default = ensureSource;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW5zdXJlU291cmNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vbGliL3V0aWxzL2Vuc3VyZVNvdXJjZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFjQSxNQUFNLFlBQVksR0FBRyxLQUFLLEVBQ3hCLE9BQTRCLEVBQzVCLFFBQXdDLEVBQ3hDLEtBQThCLEVBQ1MsRUFBRTtJQUN6QyxNQUFNLEtBQUssR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsSUFBSSxLQUFLLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUM1RCxJQUFJLEtBQUssS0FBSyxTQUFTLEVBQUU7UUFDdkIsT0FBTyxLQUFLLENBQUM7S0FDZDtJQUVELE1BQU0sU0FBUyxHQUFHLE1BQU0sT0FBTyxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNwRCxRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBRXpCLE9BQU8sU0FBUyxDQUFDO0FBQ25CLENBQUMsQ0FBQztBQUVGLE1BQU0sMEJBQTBCLEdBQUcsS0FBSyxFQUN0QyxPQUE0QixFQUM1QixRQUF3QyxFQUN4QyxLQUE0QyxFQUNMLEVBQUU7SUFDekMsTUFBTSxFQUFFLG9CQUFvQixFQUFFLFdBQVcsRUFBRSxHQUFHLEtBQUssQ0FBQztJQUNwRCxNQUFNLGlCQUFpQixHQUFHLEdBQUcsV0FBVyxNQUFNLG9CQUFvQixFQUFFLENBQUM7SUFFckUsT0FBTyxNQUFNLFlBQVksQ0FBQyxPQUFPLEVBQUUsUUFBUSxFQUFFO1FBQzNDLElBQUksRUFBRSxvQkFBb0I7UUFDMUIsaUJBQWlCLEVBQUUsaUJBQWlCO1FBQ3BDLElBQUksRUFBRSx3QkFBd0I7S0FDL0IsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDO0FBaUJPLGdFQUEwQjtBQWZuQyxNQUFNLDJCQUEyQixHQUFHLEtBQUssRUFDdkMsT0FBNEIsRUFDNUIsUUFBd0MsRUFDeEMsS0FBNkMsRUFDTixFQUFFO0lBQ3pDLE1BQU0sRUFBRSxvQkFBb0IsRUFBRSxhQUFhLEVBQUUsR0FBRyxLQUFLLENBQUM7SUFDdEQsTUFBTSxpQkFBaUIsR0FBRyxHQUFHLGFBQWEsTUFBTSxvQkFBb0IsRUFBRSxDQUFDO0lBRXZFLE9BQU8sTUFBTSxZQUFZLENBQUMsT0FBTyxFQUFFLFFBQVEsRUFBRTtRQUMzQyxJQUFJLEVBQUUsb0JBQW9CO1FBQzFCLGlCQUFpQixFQUFFLGlCQUFpQjtRQUNwQyxJQUFJLEVBQUUseUJBQXlCO0tBQ2hDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQztBQUVtQyxrRUFBMkI7QUFFaEUsa0JBQWUsWUFBWSxDQUFDIn0=